<!DOCTYPE html>
<html lang="mn">
<head>
  <meta charset="UTF-8">
  <title>Oyunsanaa Chat</title>
  <style>
    body { font-family: sans-serif; background:#f5f5f5; }
    .chat-container { width:400px; max-width:90%; margin:40px auto; border:1px solid #ccc; border-radius:8px; background:#fff; display:flex; flex-direction:column; height:600px; }
    .chat-messages { flex:1; padding:10px; overflow-y:auto; }
    .message { margin:6px 0; padding:8px 12px; border-radius:12px; max-width:80%; }
    .message-user { background:#d1e7ff; align-self:flex-end; }
    .message-bot { background:#eee; align-self:flex-start; }
    .chat-input { display:flex; border-top:1px solid #ccc; }
    .chat-input input { flex:1; padding:10px; border:none; outline:none; }
    .chat-input button { padding:0 16px; border:none; background:#4caf50; color:white; cursor:pointer; }
    .chat-input button:disabled { background:#aaa; }
  </style>
</head>
<body>
  <div class="chat-container">
    <div id="messages" class="chat-messages"></div>
    <div class="chat-input">
      <input id="messageInput" placeholder="–ú–µ—Å—Å–µ–∂ –±–∏—á–Ω—ç “Ø“Ø..." />
      <button id="sendButton">–ò–ª–≥—ç—ç—Ö</button>
    </div>
  </div>

  <script>
    const messagesContainer = document.getElementById('messages');
    const messageInput = document.getElementById('messageInput');
    const sendButton = document.getElementById('sendButton');
    let isSending = false;
    const history = [];

    function appendMessage(text, role='user') {
      const div = document.createElement('div');
      div.className = 'message ' + (role === 'user' ? 'message-user' : 'message-bot');
      div.textContent = text;
      messagesContainer.appendChild(div);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

  async function generateResponse(message) {
  const res = await fetch('/api/chat', {
  method:'POST', headers:{'Content-Type':'application/json'},
  body: JSON.stringify({ prompt: message })
});
const { reply } = await res.json();
        sendMessage();
      }
    });
    
  </script>
</body>
</html>
    <div class="chat-container">
        <div class="chat-header">
            <div class="logo" onclick="showEasterEgg()">üéÆ</div>
            <div class="chat-title">–û—é—É–Ω—Å–∞–Ω–∞ —á–∞—Ç</div>
            <div class="chat-subtitle">–≠–Ω–≥–∏–π–Ω –º–µ—Å—Å–µ–∂–∏–π–Ω —á–∞—Ç</div>
        </div>

        <div class="messages" id="messages">
            <div class="message message-bot">
                <div class="message-header">–û—é—É–Ω—Å–∞–Ω–∞</div>
                <div>
                    –°–∞–π–Ω –±–∞–π–Ω–∞ —É—É! –ë–∏ —Ç–∞–Ω–¥ —Ç—É—Å–ª–∞—Ö–∞–¥ –±—ç–ª—ç–Ω –±–∞–π–Ω–∞!
                    <br><br>üí¨ –ê—Å—É—É–ª—Ç –∞—Å—É—É–∂, —è—Ä–∏–ª—Ü–∞—Ü–≥–∞–∞—è!
                    <br>üéå "aoi" –≥—ç–∂ –±–∏—á–≤—ç–ª —è–ø–æ–Ω —Ö—ç–ª —Ç–∞–π–ª–±–∞—Ä–ª–∞–Ω–∞
                    <br>üòÇ –®–æ–≥ —Ö—ç–ª–∂ —á–∞–¥–Ω–∞
                    <br>‚ö° –•—É—Ä–¥–∞–Ω —Ö–∞—Ä–∏—É–ª–¥–∞–≥
                </div>
                <div class="message-time" id="welcomeTime"></div>
            </div>
        </div>

        <div class="input-area">
            <div class="quick-buttons">
                <button class="quick-btn" onclick="sendQuickMessage('–°–∞–π–Ω –±–∞–π–Ω–∞ —É—É?')">üëã –°–∞–π–Ω —É—É?</button>
                <button class="quick-btn" onclick="sendQuickMessage('–®–æ–≥ —Ö—ç–ª—ç—ç—Ä—ç–π')">üòÇ –®–æ–≥</button>
                <button class="quick-btn" onclick="sendQuickMessage('aoi')">üéå aoi</button>
                <button class="quick-btn" onclick="sendQuickMessage('–¢—É—Å–ª–∞–∞—Ä–∞–π')">üÜò –¢—É—Å–ª–∞–º–∂</button>
                <button class="quick-btn" onclick="clearChat()">üóëÔ∏è –¶—ç–≤—ç—Ä–ª—ç—Ö</button>
            </div>

            <div class="input-row">
                <textarea class="chat-input" id="messageInput" 
                          placeholder="–ú–µ—Å—Å–µ–∂ –±–∏—á–Ω—ç “Ø“Ø..." 
                          rows="1"></textarea>
                <button class="send-button" id="sendButton" onclick="sendMessage()">üöÄ</button>
            </div>
        </div>
    </div>

    <script>
        let isProcessing = false;
        let messageCount = 1;

        const messagesContainer = document.getElementById('messages');
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');

        const responses = {
            greetings: [
                '–°–∞–π–Ω –±–∞–π–Ω–∞! –¢–∞ –±–∞—Å —Å–∞–π–Ω –±–∞–π–Ω–∞ —É—É? ”®–Ω”©”©–¥”©—Ä —è–º–∞—Ä —Å–∞–π—Ö–∞–Ω ”©–¥”©—Ä –±–∞–π–Ω–∞! üòä',
                '–ú–∞—à —Å–∞–π–Ω –±–∞–π–Ω–∞! –¢–∞–Ω–∞–π—Ö —Ö—ç—Ä –±–∞–π–Ω–∞? üåü',
                '–°–∞–π—Ö–∞–Ω –±–∞–π–Ω–∞! –¢–∞–Ω—ã–≥ —Ö–∞—Ä–∞—Ö–∞–¥ –±–∞—è—Ä—Ç–∞–π –±–∞–π–Ω–∞! üéâ'
            ],
            aoi: [
                'Aoi –≥—ç–¥—ç–≥ –Ω—å —è–ø–æ–Ω —Ö—ç–ª –¥—ç—ç—Ä "—Ü—ç–Ω—Ö—ç—Ä" –≥—ç—Å—ç–Ω —É—Ç–≥–∞—Ç–∞–π! üíô –ú–∞—à —Å–∞–π—Ö–∞–Ω ”©–Ω–≥”© –±–∞–π–Ω–∞ –¥–∞–∞!',
                'Aoi (Èùí) - —ç–Ω—ç –Ω—å —è–ø–æ–Ω —Ö—ç–ª—ç—ç—Ä —Ü—ç–Ω—Ö—ç—Ä ”©–Ω–≥”© –≥—ç—Å—ç–Ω “Ø–≥ —é–º! –¢—ç–Ω–≥—ç—Ä–∏–π–Ω ”©–Ω–≥”©! üåå',
                'Èùí„ÅÑ (aoi) –≥—ç–¥—ç–≥ –Ω—å —Ü—ç–Ω—Ö—ç—Ä, –Ω–æ–≥–æ–æ–Ω ”©–Ω–≥–∏–π–≥ –∏–ª—ç—Ä—Ö–∏–π–ª–¥—ç–≥ —è–ø–æ–Ω “Ø–≥! üíöüíô'
            ],
            jokes: [
                '–ü—Ä–æ–≥—Ä–∞–º—á–∏–π–Ω —à–æ–≥:\n\n–Ø–∞–≥–∞–∞–¥ JS –±–æ–ª–æ–Ω Java –∞–¥–∏–ª–≥“Ø–π –≤—ç?\n–ì–∞—Ä –±–æ–ª–æ–Ω –≥–∞—Ä—ã–Ω –≥–∞–∑–∞—Ä –∞–¥–∏–ª–≥“Ø–π —à–∏–≥! üòÑ',
                'IT —à–æ–≥:\n\n–Ø–∞–≥–∞–∞–¥ –∫–æ–º–ø—å—é—Ç–µ—Ä —ç–º—á —Ä“Ø“Ø —è–≤—Å–∞–Ω –±—ç?\n–í–∏—Ä—É—Å –∞–≤—á–∏—Ö—Å–∞–Ω —É—á—Ä–∞–∞—Å! üíªüò∑',
                '–ö–æ–¥—ã–Ω —à–æ–≥:\n\n"–ú–∏–Ω–∏–π –∫–æ–¥ —è–∞–≥–∞–∞–¥ –∞–∂–∏–ª–ª–∞—Ö–≥“Ø–π –±–∞–π–Ω–∞ –≤—ç?"\n"–ß–∏ ; —Ç–∞–≤–∏–∂ –º–∞—Ä—Ç—Å–∞–Ω!" üòÖ'
            ],
            help: [
                '–ë–∏ —Ç–∞–Ω–¥ —ç–¥–≥—ç—ç—Ä—ç—ç—Ä —Ç—É—Å–ª–∞–∂ —á–∞–¥–Ω–∞:\n\nüí≠ –ï—Ä”©–Ω—Ö–∏–π –∞—Å—É—É–ª—Ç —Ö–∞—Ä–∏—É–ª—Ç\nüòÑ –®–æ–≥, —Ö”©–≥–∂–∏–ª—Ç—ç–π –º—ç–¥—ç—ç–ª—ç–ª\nüéå –Ø–ø–æ–Ω —Ö—ç–ª –¥—ç–º–∂–ª—ç–≥ (aoi –≥—ç—Ö –º—ç—Ç “Ø–≥—Å)\nüí° –ó”©–≤–ª”©–≥”©”© ”©–≥”©—Ö\n\n–Æ—É —Ö—ç—Ä—ç–≥—Ç—ç–π –±–∞–π–Ω–∞ –≤—ç?',
                '–¢–∞–Ω–¥ —Ç—É—Å–ª–∞—Ö–∞–¥ –±—ç–ª—ç–Ω –±–∞–π–Ω–∞! –ù–∞–¥–∞–∞—Å —é—É –∞—Å—É—É–∂ –±–æ–ª–æ—Ö –≤—ç? ü§ù'
            ],
            default: [
                '–°–æ–Ω–∏—Ä—Ö–æ–ª—Ç–æ–π —é–º —Ö—ç–ª–∂ –±–∞–π–Ω–∞! –ò–ª“Ø“Ø –¥—ç–ª–≥—ç—Ä—ç–Ω–≥“Ø–π —Ö—ç–ª–∂ —á–∞–¥–∞—Ö —É—É? ü§î',
                '–û–æ–æ, —ç–Ω—ç –Ω—å –º–∏–Ω–∏–π –∞–Ω—Ö–Ω—ã —É–¥–∞–∞ —Å–æ–Ω—Å–æ–∂ –±–∞–π–Ω–∞! üòÆ',
                '–ú–∞—à —Å–∞–π–Ω —Å–∞–Ω–∞–∞ –±–∞–π–Ω–∞! –ë–∏ —Ç–∞–Ω—ã–≥ –¥—ç–º–∂–∏–∂ –±–∞–π–Ω–∞! üí™',
                '–¢–∞–Ω–¥ —Ç—É—Å–ª–∞—Ö—ã–≥ —Ö“Ø—Å—ç–∂ –±–∞–π–Ω–∞! –ù–∞–¥–∞–∞—Å —é—É –∞—Å—É—É–∂ –±–æ–ª–æ—Ö –≤—ç? ü§ù'
            ],
            goodbye: [
                '–ë–∞—è—Ä—Ç–∞–π! –î–∞—Ä–∞–∞ –¥–∞—Ö–∏–Ω —É—É–ª–∑–∞—Ü–≥–∞–∞—è! üëã‚ú®',
                '–°–∞–π—Ö–∞–Ω ”©–¥”©—Ä ”©–Ω–≥”©—Ä“Ø“Ø–ª—ç—ç—Ä—ç–π! –î–∞—Ö–∏–Ω –∏—Ä—ç—ç—Ä—ç–π! üåà',
                '–ë–∞—è—Ä–ª–∞–ª–∞–∞! –£–¥–∞—Ö–≥“Ø–π –¥–∞—Ö–∏–Ω —É—É–ª–∑–∞—Ü–≥–∞–∞—è! üí´'
            ]
        };

        document.addEventListener('DOMContentLoaded', function() {
            updateWelcomeTime();
            setupEventListeners();
            messageInput.focus();
        });

        function setupEventListeners() {
            messageInput.addEventListener('input', autoResizeTextarea);
            
            messageInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    sendMessage();
                }
            });
        }

        function updateWelcomeTime() {
            const welcomeTime = document.getElementById('welcomeTime');
            if (welcomeTime) {
                welcomeTime.textContent = getCurrentTime();
            }
        }

        function autoResizeTextarea() {
            messageInput.style.height = 'auto';
            messageInput.style.height = Math.min(messageInput.scrollHeight, 100) + 'px';
        }

        function getCurrentTime() {
            return new Date().toLocaleTimeString('mn-MN', {
                hour: '2-digit',
                minute: '2-digit'
            });
        }

        function addMessage(content, isUser = false) {
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'message-user' : 'message-bot'}`;
            
            messageDiv.innerHTML = `
                <div class="message-header">${isUser ? '–¢–∞' : '–û—é—É–Ω—Å–∞–Ω–∞'}</div>
                <div>${content}</div>
                <div class="message-time">${getCurrentTime()}</div>
            `;
            
            messagesContainer.appendChild(messageDiv);
            scrollToBottom();
            messageCount++;
            
            if (messageCount > 50) {
                const firstMessage = messagesContainer.querySelector('.message:not(:first-child)');
                if (firstMessage) {
                    messagesContainer.removeChild(firstMessage);
                    messageCount--;
                }
            }
        }

        function showTyping() {
            const typingDiv = document.createElement('div');
            typingDiv.className = 'typing-indicator';
            typingDiv.id = 'typingIndicator';
            typingDiv.innerHTML = `
                <div class="typing-dots">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            `;
            
            messagesContainer.appendChild(typingDiv);
            scrollToBottom();
            return typingDiv;
        }

        function hideTyping() {
            const typingDiv = document.getElementById('typingIndicator');
            if (typingDiv) {
                typingDiv.remove();
            }
        }

        function scrollToBottom() {
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function getRandomResponse(category) {
            const responseList = responses[category];
            return responseList[Math.floor(Math.random() * responseList.length)];
        }

        function generateResponse(message) {
            const lowerMessage = message.toLowerCase();
            
            if (lowerMessage.includes('aoi')) {
                return getRandomResponse('aoi');
            } else if (lowerMessage.includes('—Å–∞–π–Ω') || lowerMessage.includes('–º–µ–Ω–¥—ç—ç')) {
                return getRandomResponse('greetings');
            } else if (lowerMessage.includes('—à–æ–≥') || lowerMessage.includes('—Ö”©–≥–∂–∏–ª—Ç—ç–π')) {
                return getRandomResponse('jokes');
            } else if (lowerMessage.includes('—Ç—É—Å–ª–∞–∞—Ä–∞–π') || lowerMessage.includes('—Ç—É—Å–ª–∞–º–∂')) {
                return getRandomResponse('help');
            } else if (lowerMessage.includes('–±–∞—è—Ä—Ç–∞–π') || lowerMessage.includes('–±–∞—è—Ä–ª–∞–ª–∞–∞')) {
                return getRandomResponse('goodbye');
            } else {
                return getRandomResponse('default');
            }
        }

        function sendQuickMessage(message) {
            messageInput.value = message;
            sendMessage();
        }

        function clearChat() {
            const messages = messagesContainer.querySelectorAll('.message:not(:first-child)');
            messages.forEach(msg => msg.remove());
            messageCount = 1;
            addMessage('–ß–∞—Ç —Ü—ç–≤—ç—Ä–ª—ç–≥–¥–ª—ç—ç! –®–∏–Ω—ç—ç—Ä —ç—Ö—ç–ª—Ü–≥—ç—ç–µ! üÜï');
        }

        function showEasterEgg() {
            const easterEggs = [
                'üéâ –¢–∞ –Ω—É—É—Ü —Ç–æ–≤—á–∏–π–≥ –æ–ª—Å–æ–Ω –±–∞–π–Ω–∞!',
                'üéÆ –≠–Ω–≥–∏–π–Ω —Ö”©–≥–∂–∏–ª—Ç—ç–π —á–∞—Ç!',
                '‚ú® –°–∞–π—Ö–∞–Ω ”©–¥”©—Ä ”©–Ω–≥”©—Ä“Ø“Ø–ª—ç—ç—Ä—ç–π!',
                'üöÄ –ú–µ—Å—Å–µ–∂ —è–≤—É—É–ª–∂, —è—Ä–∏–ª—Ü–∞—Ü–≥–∞–∞—è!'
            ];
            const randomEgg = easterEggs[Math.floor(Math.random() * easterEggs.length)];
            addMessage(randomEgg);
        }

        function sendMessage() {
            const message = messageInput.value.trim();
            
            if (!message || isProcessing) return;
            
            isProcessing = true;
            sendButton.disabled = true;
            
            addMessage(message, true);
            
            messageInput.value = '';
            autoResizeTextarea();
            
            const typingIndicator = showTyping();
            
            const delay = 1000 + Math.random() * 2000;
            setTimeout(() => {
                hideTyping();
                const response = generateResponse(message);
                addMessage(response);
                
                isProcessing = false;
                sendButton.disabled = false;
                messageInput.focus();
            }, delay);
        }
    </script>
</body>
</html>
